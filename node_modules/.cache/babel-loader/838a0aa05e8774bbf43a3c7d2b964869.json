{"remainingRequest":"D:\\Code\\Web\\member-system\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\Web\\member-system\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Code\\Web\\member-system\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\Code\\Web\\member-system\\src\\store\\modules\\permission.js","mtime":1672242736789},{"path":"D:\\Code\\Web\\member-system\\babel.config.js","mtime":1672242736758},{"path":"D:\\Code\\Web\\member-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672242978934},{"path":"D:\\Code\\Web\\member-system\\node_modules\\babel-loader\\lib\\index.js","mtime":1672242978919},{"path":"D:\\Code\\Web\\member-system\\node_modules\\eslint-loader\\index.js","mtime":1672242974622}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovQ29kZS9XZWIvbWVtYmVyLXN5c3RlbS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgeyBhc3luY1JvdXRlcywgY29uc3RhbnRSb3V0ZXMgfSBmcm9tICdAL3JvdXRlcic7CgovKioNCiAqIFVzZSBtZXRhLnJvbGUgdG8gZGV0ZXJtaW5lIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIHBlcm1pc3Npb24NCiAqIEBwYXJhbSByb2xlcw0KICogQHBhcmFtIHJvdXRlDQogKi8KZnVuY3Rpb24gaGFzUGVybWlzc2lvbihyb2xlcywgcm91dGUpIHsKICBpZiAocm91dGUubWV0YSAmJiByb3V0ZS5tZXRhLnJvbGVzKSB7CiAgICByZXR1cm4gcm9sZXMuc29tZShmdW5jdGlvbiAocm9sZSkgewogICAgICByZXR1cm4gcm91dGUubWV0YS5yb2xlcy5pbmNsdWRlcyhyb2xlKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKg0KICogRmlsdGVyIGFzeW5jaHJvbm91cyByb3V0aW5nIHRhYmxlcyBieSByZWN1cnNpb24NCiAqIEBwYXJhbSByb3V0ZXMgYXN5bmNSb3V0ZXMNCiAqIEBwYXJhbSByb2xlcw0KICovCmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcyhyb3V0ZXMsIHJvbGVzKSB7CiAgdmFyIHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgdmFyIHRtcCA9IF9vYmplY3RTcHJlYWQoe30sIHJvdXRlKTsKICAgIGlmIChoYXNQZXJtaXNzaW9uKHJvbGVzLCB0bXApKSB7CiAgICAgIGlmICh0bXAuY2hpbGRyZW4pIHsKICAgICAgICB0bXAuY2hpbGRyZW4gPSBmaWx0ZXJBc3luY1JvdXRlcyh0bXAuY2hpbGRyZW4sIHJvbGVzKTsKICAgICAgfQogICAgICByZXMucHVzaCh0bXApOwogICAgfQogIH0pOwogIHJldHVybiByZXM7Cn0KdmFyIHN0YXRlID0gewogIHJvdXRlczogW10sCiAgYWRkUm91dGVzOiBbXQp9Owp2YXIgbXV0YXRpb25zID0gewogIFNFVF9ST1VURVM6IGZ1bmN0aW9uIFNFVF9ST1VURVMoc3RhdGUsIHJvdXRlcykgewogICAgc3RhdGUuYWRkUm91dGVzID0gcm91dGVzOwogICAgc3RhdGUucm91dGVzID0gY29uc3RhbnRSb3V0ZXMuY29uY2F0KHJvdXRlcyk7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBnZW5lcmF0ZVJvdXRlczogZnVuY3Rpb24gZ2VuZXJhdGVSb3V0ZXMoX3JlZiwgcm9sZXMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICB2YXIgYWNjZXNzZWRSb3V0ZXM7CiAgICAgIGlmIChyb2xlcy5pbmNsdWRlcygnYWRtaW4nKSkgewogICAgICAgIGFjY2Vzc2VkUm91dGVzID0gYXN5bmNSb3V0ZXMgfHwgW107CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBmaWx0ZXJBc3luY1JvdXRlcyhhc3luY1JvdXRlcywgcm9sZXMpOwogICAgICB9CiAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgcmVzb2x2ZShhY2Nlc3NlZFJvdXRlcyk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07"},{"version":3,"names":["asyncRoutes","constantRoutes","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","commit","Promise","resolve","accessedRoutes","namespaced"],"sources":["D:/Code/Web/member-system/src/store/modules/permission.js"],"sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\r\n\r\n/**\r\n * Use meta.role to determine if the current user has permission\r\n * @param roles\r\n * @param route\r\n */\r\nfunction hasPermission(roles, route) {\r\n  if (route.meta && route.meta.roles) {\r\n    return roles.some(role => route.meta.roles.includes(role))\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * Filter asynchronous routing tables by recursion\r\n * @param routes asyncRoutes\r\n * @param roles\r\n */\r\nexport function filterAsyncRoutes(routes, roles) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (hasPermission(roles, tmp)) {\r\n      if (tmp.children) {\r\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\r\n      }\r\n      res.push(tmp)\r\n    }\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nconst state = {\r\n  routes: [],\r\n  addRoutes: []\r\n}\r\n\r\nconst mutations = {\r\n  SET_ROUTES: (state, routes) => {\r\n    state.addRoutes = routes\r\n    state.routes = constantRoutes.concat(routes)\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  generateRoutes({ commit }, roles) {\r\n    return new Promise(resolve => {\r\n      let accessedRoutes\r\n      if (roles.includes('admin')) {\r\n        accessedRoutes = asyncRoutes || []\r\n      } else {\r\n        accessedRoutes = filterAsyncRoutes(asyncRoutes, roles)\r\n      }\r\n      commit('SET_ROUTES', accessedRoutes)\r\n      resolve(accessedRoutes)\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"],"mappings":";;;;;;AAAA,SAASA,WAAW,EAAEC,cAAc,QAAQ,UAAU;;AAEtD;AACA;AACA;AACA;AACA;AACA,SAASC,aAAa,CAACC,KAAK,EAAEC,KAAK,EAAE;EACnC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,KAAK,EAAE;IAClC,OAAOA,KAAK,CAACG,IAAI,CAAC,UAAAC,IAAI;MAAA,OAAIH,KAAK,CAACC,IAAI,CAACF,KAAK,CAACK,QAAQ,CAACD,IAAI,CAAC;IAAA,EAAC;EAC5D,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASE,iBAAiB,CAACC,MAAM,EAAEP,KAAK,EAAE;EAC/C,IAAMQ,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAAC,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,qBAAQT,KAAK,CAAE;IACxB,IAAIF,aAAa,CAACC,KAAK,EAAEU,GAAG,CAAC,EAAE;MAC7B,IAAIA,GAAG,CAACC,QAAQ,EAAE;QAChBD,GAAG,CAACC,QAAQ,GAAGL,iBAAiB,CAACI,GAAG,CAACC,QAAQ,EAAEX,KAAK,CAAC;MACvD;MACAQ,GAAG,CAACI,IAAI,CAACF,GAAG,CAAC;IACf;EACF,CAAC,CAAC;EAEF,OAAOF,GAAG;AACZ;AAEA,IAAMK,KAAK,GAAG;EACZN,MAAM,EAAE,EAAE;EACVO,SAAS,EAAE;AACb,CAAC;AAED,IAAMC,SAAS,GAAG;EAChBC,UAAU,EAAE,oBAACH,KAAK,EAAEN,MAAM,EAAK;IAC7BM,KAAK,CAACC,SAAS,GAAGP,MAAM;IACxBM,KAAK,CAACN,MAAM,GAAGT,cAAc,CAACmB,MAAM,CAACV,MAAM,CAAC;EAC9C;AACF,CAAC;AAED,IAAMW,OAAO,GAAG;EACdC,cAAc,gCAAanB,KAAK,EAAE;IAAA,IAAjBoB,MAAM,QAANA,MAAM;IACrB,OAAO,IAAIC,OAAO,CAAC,UAAAC,OAAO,EAAI;MAC5B,IAAIC,cAAc;MAClB,IAAIvB,KAAK,CAACK,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC3BkB,cAAc,GAAG1B,WAAW,IAAI,EAAE;MACpC,CAAC,MAAM;QACL0B,cAAc,GAAGjB,iBAAiB,CAACT,WAAW,EAAEG,KAAK,CAAC;MACxD;MACAoB,MAAM,CAAC,YAAY,EAAEG,cAAc,CAAC;MACpCD,OAAO,CAACC,cAAc,CAAC;IACzB,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAe;EACbC,UAAU,EAAE,IAAI;EAChBX,KAAK,EAALA,KAAK;EACLE,SAAS,EAATA,SAAS;EACTG,OAAO,EAAPA;AACF,CAAC"}]}