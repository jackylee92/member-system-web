{"remainingRequest":"D:\\Code\\Web\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\Web\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Code\\Web\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Web\\vue-element-admin\\src\\views\\permission\\role.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Code\\Web\\vue-element-admin\\src\\views\\permission\\role.vue","mtime":1672242736806},{"path":"D:\\Code\\Web\\vue-element-admin\\babel.config.js","mtime":1672242736758},{"path":"D:\\Code\\Web\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672242978934},{"path":"D:\\Code\\Web\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1672242978919},{"path":"D:\\Code\\Web\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672242978934},{"path":"D:\\Code\\Web\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1672242972231}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovQ29kZS9XZWIvdnVlLWVsZW1lbnQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkQ6L0NvZGUvV2ViL3Z1ZS1lbGVtZW50LWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICJEOi9Db2RlL1dlYi92dWUtZWxlbWVudC1hZG1pbi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkQ6L0NvZGUvV2ViL3Z1ZS1lbGVtZW50LWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDovQ29kZS9XZWIvdnVlLWVsZW1lbnQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCgppbXBvcnQgcGF0aCBmcm9tICdwYXRoJzsKaW1wb3J0IHsgZGVlcENsb25lIH0gZnJvbSAnQC91dGlscyc7CmltcG9ydCB7IGdldFJvdXRlcyBhcyBfZ2V0Um91dGVzLCBnZXRSb2xlcyBhcyBfZ2V0Um9sZXMsIGFkZFJvbGUsIGRlbGV0ZVJvbGUsIHVwZGF0ZVJvbGUgfSBmcm9tICdAL2FwaS9yb2xlJzsKdmFyIGRlZmF1bHRSb2xlID0gewogIGtleTogJycsCiAgbmFtZTogJycsCiAgZGVzY3JpcHRpb246ICcnLAogIHJvdXRlczogW10KfTsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICByb2xlOiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0Um9sZSksCiAgICAgIHJvdXRlczogW10sCiAgICAgIHJvbGVzTGlzdDogW10sCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBkaWFsb2dUeXBlOiAnbmV3JywKICAgICAgY2hlY2tTdHJpY3RseTogZmFsc2UsCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGNoaWxkcmVuOiAnY2hpbGRyZW4nLAogICAgICAgIGxhYmVsOiAndGl0bGUnCiAgICAgIH0KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgcm91dGVzRGF0YTogZnVuY3Rpb24gcm91dGVzRGF0YSgpIHsKICAgICAgcmV0dXJuIHRoaXMucm91dGVzOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIC8vIE1vY2s6IGdldCBhbGwgcm91dGVzIGFuZCByb2xlcyBsaXN0IGZyb20gc2VydmVyCiAgICB0aGlzLmdldFJvdXRlcygpOwogICAgdGhpcy5nZXRSb2xlcygpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0Um91dGVzOiBmdW5jdGlvbiBnZXRSb3V0ZXMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gX2dldFJvdXRlcygpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBfdGhpcy5zZXJ2aWNlUm91dGVzID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgX3RoaXMucm91dGVzID0gX3RoaXMuZ2VuZXJhdGVSb3V0ZXMocmVzLmRhdGEpOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZ2V0Um9sZXM6IGZ1bmN0aW9uIGdldFJvbGVzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBfZ2V0Um9sZXMoKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIF90aGlzMi5yb2xlc0xpc3QgPSByZXMuZGF0YTsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gUmVzaGFwZSB0aGUgcm91dGVzIHN0cnVjdHVyZSBzbyB0aGF0IGl0IGxvb2tzIHRoZSBzYW1lIGFzIHRoZSBzaWRlYmFyCiAgICBnZW5lcmF0ZVJvdXRlczogZnVuY3Rpb24gZ2VuZXJhdGVSb3V0ZXMocm91dGVzKSB7CiAgICAgIHZhciBiYXNlUGF0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJy8nOwogICAgICB2YXIgcmVzID0gW107CiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyb3V0ZXMpLAogICAgICAgIF9zdGVwOwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcm91dGUgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgIC8vIHNraXAgc29tZSByb3V0ZQogICAgICAgICAgaWYgKHJvdXRlLmhpZGRlbikgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBvbmx5T25lU2hvd2luZ0NoaWxkID0gdGhpcy5vbmx5T25lU2hvd2luZ0NoaWxkKHJvdXRlLmNoaWxkcmVuLCByb3V0ZSk7CiAgICAgICAgICBpZiAocm91dGUuY2hpbGRyZW4gJiYgb25seU9uZVNob3dpbmdDaGlsZCAmJiAhcm91dGUuYWx3YXlzU2hvdykgewogICAgICAgICAgICByb3V0ZSA9IG9ubHlPbmVTaG93aW5nQ2hpbGQ7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAgICAgcGF0aDogcGF0aC5yZXNvbHZlKGJhc2VQYXRoLCByb3V0ZS5wYXRoKSwKICAgICAgICAgICAgdGl0bGU6IHJvdXRlLm1ldGEgJiYgcm91dGUubWV0YS50aXRsZQogICAgICAgICAgfTsKCiAgICAgICAgICAvLyByZWN1cnNpdmUgY2hpbGQgcm91dGVzCiAgICAgICAgICBpZiAocm91dGUuY2hpbGRyZW4pIHsKICAgICAgICAgICAgZGF0YS5jaGlsZHJlbiA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXMocm91dGUuY2hpbGRyZW4sIGRhdGEucGF0aCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXMucHVzaChkYXRhKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzOwogICAgfSwKICAgIGdlbmVyYXRlQXJyOiBmdW5jdGlvbiBnZW5lcmF0ZUFycihyb3V0ZXMpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHZhciBkYXRhID0gW107CiAgICAgIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgICAgIGRhdGEucHVzaChyb3V0ZSk7CiAgICAgICAgaWYgKHJvdXRlLmNoaWxkcmVuKSB7CiAgICAgICAgICB2YXIgdGVtcCA9IF90aGlzMy5nZW5lcmF0ZUFycihyb3V0ZS5jaGlsZHJlbik7CiAgICAgICAgICBpZiAodGVtcC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGRhdGEgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGRhdGEpLCBfdG9Db25zdW1hYmxlQXJyYXkodGVtcCkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSwKICAgIGhhbmRsZUFkZFJvbGU6IGZ1bmN0aW9uIGhhbmRsZUFkZFJvbGUoKSB7CiAgICAgIHRoaXMucm9sZSA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRSb2xlKTsKICAgICAgaWYgKHRoaXMuJHJlZnMudHJlZSkgewogICAgICAgIHRoaXMuJHJlZnMudHJlZS5zZXRDaGVja2VkTm9kZXMoW10pOwogICAgICB9CiAgICAgIHRoaXMuZGlhbG9nVHlwZSA9ICduZXcnOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZUVkaXQ6IGZ1bmN0aW9uIGhhbmRsZUVkaXQoc2NvcGUpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHRoaXMuZGlhbG9nVHlwZSA9ICdlZGl0JzsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5jaGVja1N0cmljdGx5ID0gdHJ1ZTsKICAgICAgdGhpcy5yb2xlID0gZGVlcENsb25lKHNjb3BlLnJvdyk7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcm91dGVzID0gX3RoaXM0LmdlbmVyYXRlUm91dGVzKF90aGlzNC5yb2xlLnJvdXRlcyk7CiAgICAgICAgX3RoaXM0LiRyZWZzLnRyZWUuc2V0Q2hlY2tlZE5vZGVzKF90aGlzNC5nZW5lcmF0ZUFycihyb3V0ZXMpKTsKICAgICAgICAvLyBzZXQgY2hlY2tlZCBzdGF0ZSBvZiBhIG5vZGUgbm90IGFmZmVjdHMgaXRzIGZhdGhlciBhbmQgY2hpbGQgbm9kZXMKICAgICAgICBfdGhpczQuY2hlY2tTdHJpY3RseSA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVEZWxldGU6IGZ1bmN0aW9uIGhhbmRsZURlbGV0ZShfcmVmKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICB2YXIgJGluZGV4ID0gX3JlZi4kaW5kZXgsCiAgICAgICAgcm93ID0gX3JlZi5yb3c7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ0NvbmZpcm0gdG8gcmVtb3ZlIHRoZSByb2xlPycsICdXYXJuaW5nJywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnQ29uZmlybScsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ0NhbmNlbCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIGRlbGV0ZVJvbGUocm93LmtleSk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBfdGhpczUucm9sZXNMaXN0LnNwbGljZSgkaW5kZXgsIDEpOwogICAgICAgICAgICAgIF90aGlzNS4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnRGVsZXRlIHN1Y2NlZCEnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2VuZXJhdGVUcmVlOiBmdW5jdGlvbiBnZW5lcmF0ZVRyZWUocm91dGVzKSB7CiAgICAgIHZhciBiYXNlUGF0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJy8nOwogICAgICB2YXIgY2hlY2tlZEtleXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIHJlcyA9IFtdOwogICAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJvdXRlcyksCiAgICAgICAgX3N0ZXAyOwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcm91dGUgPSBfc3RlcDIudmFsdWU7CiAgICAgICAgICB2YXIgcm91dGVQYXRoID0gcGF0aC5yZXNvbHZlKGJhc2VQYXRoLCByb3V0ZS5wYXRoKTsKCiAgICAgICAgICAvLyByZWN1cnNpdmUgY2hpbGQgcm91dGVzCiAgICAgICAgICBpZiAocm91dGUuY2hpbGRyZW4pIHsKICAgICAgICAgICAgcm91dGUuY2hpbGRyZW4gPSB0aGlzLmdlbmVyYXRlVHJlZShyb3V0ZS5jaGlsZHJlbiwgcm91dGVQYXRoLCBjaGVja2VkS2V5cyk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoY2hlY2tlZEtleXMuaW5jbHVkZXMocm91dGVQYXRoKSB8fCByb3V0ZS5jaGlsZHJlbiAmJiByb3V0ZS5jaGlsZHJlbi5sZW5ndGggPj0gMSkgewogICAgICAgICAgICByZXMucHVzaChyb3V0ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzOwogICAgfSwKICAgIGNvbmZpcm1Sb2xlOiBmdW5jdGlvbiBjb25maXJtUm9sZSgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBpc0VkaXQsIGNoZWNrZWRLZXlzLCBpbmRleCwgX3lpZWxkJGFkZFJvbGUsIGRhdGEsIF90aGlzNiRyb2xlLCBkZXNjcmlwdGlvbiwga2V5LCBuYW1lOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpc0VkaXQgPSBfdGhpczYuZGlhbG9nVHlwZSA9PT0gJ2VkaXQnOwogICAgICAgICAgICAgIGNoZWNrZWRLZXlzID0gX3RoaXM2LiRyZWZzLnRyZWUuZ2V0Q2hlY2tlZEtleXMoKTsKICAgICAgICAgICAgICBfdGhpczYucm9sZS5yb3V0ZXMgPSBfdGhpczYuZ2VuZXJhdGVUcmVlKGRlZXBDbG9uZShfdGhpczYuc2VydmljZVJvdXRlcyksICcvJywgY2hlY2tlZEtleXMpOwogICAgICAgICAgICAgIGlmICghaXNFZGl0KSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlUm9sZShfdGhpczYucm9sZS5rZXksIF90aGlzNi5yb2xlKTsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGluZGV4ID0gMDsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGlmICghKGluZGV4IDwgX3RoaXM2LnJvbGVzTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghKF90aGlzNi5yb2xlc0xpc3RbaW5kZXhdLmtleSA9PT0gX3RoaXM2LnJvbGUua2V5KSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfdGhpczYucm9sZXNMaXN0LnNwbGljZShpbmRleCwgMSwgT2JqZWN0LmFzc2lnbih7fSwgX3RoaXM2LnJvbGUpKTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgiYnJlYWsiLCAxNCk7CiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgaW5kZXgrKzsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE4OwogICAgICAgICAgICAgIHJldHVybiBhZGRSb2xlKF90aGlzNi5yb2xlKTsKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICBfeWllbGQkYWRkUm9sZSA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkYWRkUm9sZS5kYXRhOwogICAgICAgICAgICAgIF90aGlzNi5yb2xlLmtleSA9IGRhdGEua2V5OwogICAgICAgICAgICAgIF90aGlzNi5yb2xlc0xpc3QucHVzaChfdGhpczYucm9sZSk7CiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgX3RoaXM2JHJvbGUgPSBfdGhpczYucm9sZSwgZGVzY3JpcHRpb24gPSBfdGhpczYkcm9sZS5kZXNjcmlwdGlvbiwga2V5ID0gX3RoaXM2JHJvbGUua2V5LCBuYW1lID0gX3RoaXM2JHJvbGUubmFtZTsKICAgICAgICAgICAgICBfdGhpczYuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIF90aGlzNi4kbm90aWZ5KHsKICAgICAgICAgICAgICAgIHRpdGxlOiAnU3VjY2VzcycsCiAgICAgICAgICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiXG4gICAgICAgICAgICA8ZGl2PlJvbGUgS2V5OiAiLmNvbmNhdChrZXksICI8L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+Um9sZSBOYW1lOiAiKS5jb25jYXQobmFtZSwgIjwvZGl2PlxuICAgICAgICAgICAgPGRpdj5EZXNjcmlwdGlvbjogIikuY29uY2F0KGRlc2NyaXB0aW9uLCAiPC9kaXY+XG4gICAgICAgICAgIiksCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIHJlZmVyZW5jZTogc3JjL3ZpZXcvbGF5b3V0L2NvbXBvbmVudHMvU2lkZWJhci9TaWRlYmFySXRlbS52dWUKICAgIG9ubHlPbmVTaG93aW5nQ2hpbGQ6IGZ1bmN0aW9uIG9ubHlPbmVTaG93aW5nQ2hpbGQoKSB7CiAgICAgIHZhciBjaGlsZHJlbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107CiAgICAgIHZhciBwYXJlbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIG9ubHlPbmVDaGlsZCA9IG51bGw7CiAgICAgIHZhciBzaG93aW5nQ2hpbGRyZW4gPSBjaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gIWl0ZW0uaGlkZGVuOwogICAgICB9KTsKCiAgICAgIC8vIFdoZW4gdGhlcmUgaXMgb25seSBvbmUgY2hpbGQgcm91dGUsIHRoZSBjaGlsZCByb3V0ZSBpcyBkaXNwbGF5ZWQgYnkgZGVmYXVsdAogICAgICBpZiAoc2hvd2luZ0NoaWxkcmVuLmxlbmd0aCA9PT0gMSkgewogICAgICAgIG9ubHlPbmVDaGlsZCA9IHNob3dpbmdDaGlsZHJlblswXTsKICAgICAgICBvbmx5T25lQ2hpbGQucGF0aCA9IHBhdGgucmVzb2x2ZShwYXJlbnQucGF0aCwgb25seU9uZUNoaWxkLnBhdGgpOwogICAgICAgIHJldHVybiBvbmx5T25lQ2hpbGQ7CiAgICAgIH0KCiAgICAgIC8vIFNob3cgcGFyZW50IGlmIHRoZXJlIGFyZSBubyBjaGlsZCByb3V0ZSB0byBkaXNwbGF5CiAgICAgIGlmIChzaG93aW5nQ2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7CiAgICAgICAgb25seU9uZUNoaWxkID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBwYXJlbnQpLCB7fSwgewogICAgICAgICAgcGF0aDogJycsCiAgICAgICAgICBub1Nob3dpbmdDaGlsZHJlbjogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIHJldHVybiBvbmx5T25lQ2hpbGQ7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AAEA;EACAA;EACAC;EACAC;EACAC;AACA;AAEA;EACAC;IACA;MACAC;MACAF;MACAG;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;EACA;EACAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAA;YAAA;cAAAC;cACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAA;YAAA;cAAAD;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAE;MAAA;MACA;MAAA,2CAEAjB;QAAA;MAAA;QAAA;UAAA;UACA;UACA;YAAA;UAAA;UAEA;UAEA;YACAkB;UACA;UAEA;YACAC;YACAC;UAEA;;UAEA;UACA;YACAnB;UACA;UACAc;QACA;MAAA;QAAA;MAAA;QAAA;MAAA;MACA;IACA;IACAM;MAAA;MACA;MACArB;QACAC;QACA;UACA;UACA;YACAA;UACA;QACA;MACA;MACA;IACA;IACAqB;MACA;MACA;QACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAAC;MACA;QACAC;QACAC;QACAC;MACA,GACAC;QAAA;UAAA;YAAA;cAAA;cAAA,OACAC;YAAA;cACA;cACA;gBACAF;gBACAG;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA,CACA,IACAC;QAAAC;MAAA;IACA;IACAC;MAAA;MAAA;MACA;MAAA,4CAEAlC;QAAA;MAAA;QAAA;UAAA;UACA;;UAEA;UACA;YACAkB;UACA;UAEA;YACAH;UACA;QACA;MAAA;QAAA;MAAA;QAAA;MAAA;MACA;IACA;IACAoB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cACAC;cAEAC;cACA;cAAA,KAEAD;gBAAA;gBAAA;cAAA;cAAA;cAAA,OACAE;YAAA;cACAC;YAAA;cAAA;gBAAA;gBAAA;cAAA;cAAA,MACA;gBAAA;gBAAA;cAAA;cACA;cAAA;YAAA;cAFAA;cAAA;cAAA;YAAA;cAAA;cAAA;YAAA;cAAA;cAAA,OAOAC;YAAA;cAAA;cAAAvC;cACA;cACA;YAAA;cAAA,cAGA;cACA;cACA;gBACAmB;gBACAqB;gBACAV,gDACAlC,oDACAC,uDACAC,kCACA;gBACA6B;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAc;MAAA;MAAA;MACA;MACA;QAAA;MAAA;;MAEA;MACA;QACAC;QACAA;QACA;MACA;;MAEA;MACA;QACAA;UAAAxB;UAAAyB;QAAA;QACA;MACA;MAEA;IACA;EACA;AACA","names":["key","name","description","routes","data","role","rolesList","dialogVisible","dialogType","checkStrictly","defaultProps","children","label","computed","routesData","created","methods","getRoutes","res","getRoles","generateRoutes","route","path","title","generateArr","handleAddRole","handleEdit","handleDelete","row","confirmButtonText","cancelButtonText","type","then","deleteRole","message","catch","console","generateTree","confirmRole","isEdit","checkedKeys","updateRole","index","addRole","dangerouslyUseHTMLString","onlyOneShowingChild","onlyOneChild","noShowingChildren"],"sourceRoot":"src/views/permission","sources":["role.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-button type=\"primary\" @click=\"handleAddRole\">New Role</el-button>\r\n\r\n    <el-table :data=\"rolesList\" style=\"width: 100%;margin-top:30px;\" border>\r\n      <el-table-column align=\"center\" label=\"Role Key\" width=\"220\">\r\n        <template slot-scope=\"scope\">\r\n          {{ scope.row.key }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"Role Name\" width=\"220\">\r\n        <template slot-scope=\"scope\">\r\n          {{ scope.row.name }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"header-center\" label=\"Description\">\r\n        <template slot-scope=\"scope\">\r\n          {{ scope.row.description }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"Operations\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"primary\" size=\"small\" @click=\"handleEdit(scope)\">Edit</el-button>\r\n          <el-button type=\"danger\" size=\"small\" @click=\"handleDelete(scope)\">Delete</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-dialog :visible.sync=\"dialogVisible\" :title=\"dialogType==='edit'?'Edit Role':'New Role'\">\r\n      <el-form :model=\"role\" label-width=\"80px\" label-position=\"left\">\r\n        <el-form-item label=\"Name\">\r\n          <el-input v-model=\"role.name\" placeholder=\"Role Name\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"Desc\">\r\n          <el-input\r\n            v-model=\"role.description\"\r\n            :autosize=\"{ minRows: 2, maxRows: 4}\"\r\n            type=\"textarea\"\r\n            placeholder=\"Role Description\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"Menus\">\r\n          <el-tree\r\n            ref=\"tree\"\r\n            :check-strictly=\"checkStrictly\"\r\n            :data=\"routesData\"\r\n            :props=\"defaultProps\"\r\n            show-checkbox\r\n            node-key=\"path\"\r\n            class=\"permission-tree\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <div style=\"text-align:right;\">\r\n        <el-button type=\"danger\" @click=\"dialogVisible=false\">Cancel</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmRole\">Confirm</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport path from 'path'\r\nimport { deepClone } from '@/utils'\r\nimport { getRoutes, getRoles, addRole, deleteRole, updateRole } from '@/api/role'\r\n\r\nconst defaultRole = {\r\n  key: '',\r\n  name: '',\r\n  description: '',\r\n  routes: []\r\n}\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      role: Object.assign({}, defaultRole),\r\n      routes: [],\r\n      rolesList: [],\r\n      dialogVisible: false,\r\n      dialogType: 'new',\r\n      checkStrictly: false,\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'title'\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    routesData() {\r\n      return this.routes\r\n    }\r\n  },\r\n  created() {\r\n    // Mock: get all routes and roles list from server\r\n    this.getRoutes()\r\n    this.getRoles()\r\n  },\r\n  methods: {\r\n    async getRoutes() {\r\n      const res = await getRoutes()\r\n      this.serviceRoutes = res.data\r\n      this.routes = this.generateRoutes(res.data)\r\n    },\r\n    async getRoles() {\r\n      const res = await getRoles()\r\n      this.rolesList = res.data\r\n    },\r\n\r\n    // Reshape the routes structure so that it looks the same as the sidebar\r\n    generateRoutes(routes, basePath = '/') {\r\n      const res = []\r\n\r\n      for (let route of routes) {\r\n        // skip some route\r\n        if (route.hidden) { continue }\r\n\r\n        const onlyOneShowingChild = this.onlyOneShowingChild(route.children, route)\r\n\r\n        if (route.children && onlyOneShowingChild && !route.alwaysShow) {\r\n          route = onlyOneShowingChild\r\n        }\r\n\r\n        const data = {\r\n          path: path.resolve(basePath, route.path),\r\n          title: route.meta && route.meta.title\r\n\r\n        }\r\n\r\n        // recursive child routes\r\n        if (route.children) {\r\n          data.children = this.generateRoutes(route.children, data.path)\r\n        }\r\n        res.push(data)\r\n      }\r\n      return res\r\n    },\r\n    generateArr(routes) {\r\n      let data = []\r\n      routes.forEach(route => {\r\n        data.push(route)\r\n        if (route.children) {\r\n          const temp = this.generateArr(route.children)\r\n          if (temp.length > 0) {\r\n            data = [...data, ...temp]\r\n          }\r\n        }\r\n      })\r\n      return data\r\n    },\r\n    handleAddRole() {\r\n      this.role = Object.assign({}, defaultRole)\r\n      if (this.$refs.tree) {\r\n        this.$refs.tree.setCheckedNodes([])\r\n      }\r\n      this.dialogType = 'new'\r\n      this.dialogVisible = true\r\n    },\r\n    handleEdit(scope) {\r\n      this.dialogType = 'edit'\r\n      this.dialogVisible = true\r\n      this.checkStrictly = true\r\n      this.role = deepClone(scope.row)\r\n      this.$nextTick(() => {\r\n        const routes = this.generateRoutes(this.role.routes)\r\n        this.$refs.tree.setCheckedNodes(this.generateArr(routes))\r\n        // set checked state of a node not affects its father and child nodes\r\n        this.checkStrictly = false\r\n      })\r\n    },\r\n    handleDelete({ $index, row }) {\r\n      this.$confirm('Confirm to remove the role?', 'Warning', {\r\n        confirmButtonText: 'Confirm',\r\n        cancelButtonText: 'Cancel',\r\n        type: 'warning'\r\n      })\r\n        .then(async() => {\r\n          await deleteRole(row.key)\r\n          this.rolesList.splice($index, 1)\r\n          this.$message({\r\n            type: 'success',\r\n            message: 'Delete succed!'\r\n          })\r\n        })\r\n        .catch(err => { console.error(err) })\r\n    },\r\n    generateTree(routes, basePath = '/', checkedKeys) {\r\n      const res = []\r\n\r\n      for (const route of routes) {\r\n        const routePath = path.resolve(basePath, route.path)\r\n\r\n        // recursive child routes\r\n        if (route.children) {\r\n          route.children = this.generateTree(route.children, routePath, checkedKeys)\r\n        }\r\n\r\n        if (checkedKeys.includes(routePath) || (route.children && route.children.length >= 1)) {\r\n          res.push(route)\r\n        }\r\n      }\r\n      return res\r\n    },\r\n    async confirmRole() {\r\n      const isEdit = this.dialogType === 'edit'\r\n\r\n      const checkedKeys = this.$refs.tree.getCheckedKeys()\r\n      this.role.routes = this.generateTree(deepClone(this.serviceRoutes), '/', checkedKeys)\r\n\r\n      if (isEdit) {\r\n        await updateRole(this.role.key, this.role)\r\n        for (let index = 0; index < this.rolesList.length; index++) {\r\n          if (this.rolesList[index].key === this.role.key) {\r\n            this.rolesList.splice(index, 1, Object.assign({}, this.role))\r\n            break\r\n          }\r\n        }\r\n      } else {\r\n        const { data } = await addRole(this.role)\r\n        this.role.key = data.key\r\n        this.rolesList.push(this.role)\r\n      }\r\n\r\n      const { description, key, name } = this.role\r\n      this.dialogVisible = false\r\n      this.$notify({\r\n        title: 'Success',\r\n        dangerouslyUseHTMLString: true,\r\n        message: `\r\n            <div>Role Key: ${key}</div>\r\n            <div>Role Name: ${name}</div>\r\n            <div>Description: ${description}</div>\r\n          `,\r\n        type: 'success'\r\n      })\r\n    },\r\n    // reference: src/view/layout/components/Sidebar/SidebarItem.vue\r\n    onlyOneShowingChild(children = [], parent) {\r\n      let onlyOneChild = null\r\n      const showingChildren = children.filter(item => !item.hidden)\r\n\r\n      // When there is only one child route, the child route is displayed by default\r\n      if (showingChildren.length === 1) {\r\n        onlyOneChild = showingChildren[0]\r\n        onlyOneChild.path = path.resolve(parent.path, onlyOneChild.path)\r\n        return onlyOneChild\r\n      }\r\n\r\n      // Show parent if there are no child route to display\r\n      if (showingChildren.length === 0) {\r\n        onlyOneChild = { ... parent, path: '', noShowingChildren: true }\r\n        return onlyOneChild\r\n      }\r\n\r\n      return false\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.app-container {\r\n  .roles-table {\r\n    margin-top: 30px;\r\n  }\r\n  .permission-tree {\r\n    margin-bottom: 30px;\r\n  }\r\n}\r\n</style>\r\n"]}]}